$version: 1
$input: XML
$output: XML
$sourceSchema: api_projectrequest.xsd
$targetSchema: oebs_projectrequest_body.xsd
$sourceNamespaces:
  ns4: https://SchProjectGBO.SchProjectGBO
  pjc: http://SchCustomerReference.SchCustomerReference
  b: http://schemas.microsoft.com/BizTalk/2003
  ns0: https://SchProjectGBO.PropertySchema
  xs: http://www.w3.org/2001/XMLSchema
$targetNamespaces:
  tns: http://www.dnvgl.com/EBS_Integration/masterdata/ProjectInbound
  xs: http://www.w3.org/2001/XMLSchema
tns:PROJECT_REQUEST_ROOT:
  tns:PROJECT_REQUEST:
    tns:PROJINTRF:
      $for(/ns4:projectGBO/project):
        $for(budgets/budget):
          tns:PROJECT:
            tns:FEE_PERCENTAGE: ../../feePercentage
            tns:TASKS:
              $for(/ns4:projectGBO/project):
                $for(budgetLines/budgetLine):
                  $for(task):
                    tns:TASK:
                      $if(is-greater-than-equal(int(/ns4:projectGBO/project/feeRate), 1000)):
                        tns:PM_TASK_REFERENCE: >-
                          /ns4:projectGBO/project/budgets/budget/budgetLines/budgetLine/pmTaskReference
                        tns:TASK_ID: /ns4:projectGBO/project/task/taskID
            $if(is-greater-than-equal(int(/ns4:projectGBO/project/feeRate), 1000)):
              tns:BILL_GROUP_NAME: /ns4:projectGBO/project/billGroupName
